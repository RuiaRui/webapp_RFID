<!doctype html>
<html lang="ch">

<head>
	<title>产品详情</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<!-- VENDOR CSS -->
	<link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="assets/vendor/font-awesome/css/font-awesome.min.css"> 
	<link rel="stylesheet" href="assets/vendor/linearicons/style.css">
	<link rel="stylesheet" href="assets/vendor/chartist/css/chartist-custom.css">
	<!-- MAIN CSS -->
	<link rel="stylesheet" href="assets/css/main.css">
	<link rel="stylesheet" href="assets/css/PopBoxDialog.css">
	<!-- ICONS -->
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png">

	<style>
		.point{position:absolute;left:50%; top:50%;}
		.pop{width:300px; height:400px; position:absolute;left:-150px; top:-200px; border:1px solid #444;display: none;z-index:10000; }
	</style>
</head>

<body>
	<!-- WRAPPER -->
	<div id="wrapper">
		<!-- NAVBAR -->
		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="navbar-form navbar-left">
				<a href="index.html">
					<h4>RFID管理系统</h4>
				</a>
				
			</div>
			<div class="container-fluid">
				<form class="navbar-form navbar-right">
					<div class="input-group">
						<input type="text" value="" class="form-control" placeholder="Search dashboard...">
						<span class="input-group-btn"><button type="button" class="btn btn-primary">Go</button></span>
					</div>
				</form>
				<div id="navbar-menu">
					<ul class="nav navbar-nav navbar-right">
						<li class="dropdown">
							<a href="#" class="dropdown-toggle icon-menu" data-toggle="dropdown">
								<i class="lnr lnr-alarm"></i>
								<span class="badge bg-danger">5</span>
							</a>
							<ul class="dropdown-menu notifications">
								<li><a href="#" class="notification-item"><span class="dot bg-warning"></span>System space is almost full</a></li>
								<li><a href="#" class="notification-item"><span class="dot bg-danger"></span>You have 9 unfinished tasks</a></li>
								<li><a href="#" class="notification-item"><span class="dot bg-success"></span>Monthly report is available</a></li>
								<li><a href="#" class="notification-item"><span class="dot bg-warning"></span>Weekly meeting in 1 hour</a></li>
								<li><a href="#" class="notification-item"><span class="dot bg-success"></span>Your request has been approved</a></li>
								<li><a href="#" class="more">See all notifications</a></li>
							</ul>
						</li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="lnr lnr-question-circle"></i> <span>Help</span> <i class="icon-submenu lnr lnr-chevron-down"></i></a>
							<ul class="dropdown-menu">
								<li><a href="#">Basic Use</a></li>
								<li><a href="#">Working With Data</a></li>
								<li><a href="#">Security</a></li>
								<li><a href="#">Troubleshooting</a></li>
							</ul>
						</li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown"><img src="assets/img/user.png" class="img-circle" alt="Avatar"> <span>Samuel</span> <i class="icon-submenu lnr lnr-chevron-down"></i></a>
							<ul class="dropdown-menu">
								<li><a href="#"><i class="lnr lnr-user"></i> <span>My Profile</span></a></li>
								<li><a href="#"><i class="lnr lnr-envelope"></i> <span>Message</span></a></li>
								<li><a href="#"><i class="lnr lnr-cog"></i> <span>Settings</span></a></li>
								<li><a href="#"><i class="lnr lnr-exit"></i> <span>Logout</span></a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<!-- END NAVBAR -->
		<!-- LEFT SIDEBAR -->
		<div id="sidebar-nav" class="sidebar">
			<div class="sidebar-scroll">
				<nav>
					<ul class="nav">
						<li><a href="index.html" class="active"><i class="lnr lnr-home"></i> <span>Dashboard</span></a></li>
						<li>
							<a href="#subPages" data-toggle="collapse" class="collapsed"><i class="lnr lnr-license"></i> <span>EPC管理</span> <i class="icon-submenu lnr lnr-chevron-left"></i></a>
							<div id="subPages" class="collapse ">
								<ul class="nav">
									<li><a href="showAllEPC.html" class="active">产品注册</a></li>
									<li><a href=showEPCStatus.html class="">EPC修改</a></li>
								</ul>
							</div>
						</li>
						<li><a href="showProduct.html" class=""><i class="lnr lnr-tag"></i> <span>QR管理</span></a></li>
						<li><a href="" class=""><i class="lnr lnr-store"></i> <span>库位管理</span></a></li>
						<li><a href="TagPosition.html" class=""><i class="lnr lnr-eye"></i> <span>RFID实时监控</span></a></li>
						<li><a href="TagStatus.html" class=""><i class="lnr  lnr-chart-bars"></i><span>RFID盘点</span></a></li>
						
					</ul>
				</nav>
			</div>
		</div>
		<!-- END LEFT SIDEBAR -->
		<!-- MAIN -->
		<div class="main">
			<!-- MAIN CONTENT -->
			<div class="main-content">
				<div class="container-fluid">
					<div class="panel">
						<form id="form1">
							<input type="hidden" name="">
						</form>
						<div class="panel-heading">
							<h3 class="panel-title">EPC 清单</h3>
						</div>
						<div class="panel-body">
							<table class="table table-striped" id="display">
								<thead>
								<tr>
									<th>Product ID</th>
									<th>Product Name</th>
									<th>EPC</th>
									<th>Entry Date</th>
									<th>Left Date</th>
									<th>操作</th>
								</tr>
								</thead>
<!--								<tbody>-->
<!--								<tr>-->
<!--									<td>E90239023</td>-->
<!--									<td >1001</td>-->
<!--									<td >Computer</td>-->
<!--									<td>2019-01-01</td>-->
<!--									<td>2019-12-12</td>-->
<!--									<td>-->

<!--										<button type="button" class="btn btn-primary btn-sm" onclick="show(this.id)" id="1"  >显示二维码</button>-->

<!--									</td>-->
<!--								</tr>-->

<!--								<tr>-->
<!--									<td>E90239023</td>-->
<!--									<td >1001</td>-->
<!--									<td >Computer</td>-->
<!--									<td>2019-01-01</td>-->
<!--									<td>2019-12-12</td>-->
<!--									<td>-->

<!--										<button type="button" class="btn btn-primary btn-sm " onclick="show(this.id)" id="2"  >显示二维码</button>-->

<!--									</td>-->
<!--								</tr>-->

<!--								</tbody>-->
							</table>
						</div>

					</div>

					<div class="point ">
						<div class="pop panel" id="ImageBox">
							<div class="panel-body"id="qrCode">

							</div>
							<br>
							<br>
							<div class="panel-footer">
								<button class="btn btn-primary" id="save">保存</button>
								<button class="btn btn-primary" id="btn-close">关闭</button>

							</div>

						</div>
					</div>


				</div>
			</div>
			<!-- END MAIN CONTENT -->
		</div>
		<!-- END MAIN -->
		<div class="clearfix"></div>
		
	</div>
	<!-- END WRAPPER -->
	<!-- Javascript -->
	<script src="assets/vendor/jquery/jquery.min.js"></script>
	<script src="assets/vendor/bootstrap/js/bootstrap.min.js"></script>
	<script src="assets/vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<!--	<script src="assets/vendor/jquery.easy-pie-chart/jquery.easypiechart.min.js"></script>-->
<!--	<script src="assets/vendor/chartist/js/chartist.min.js"></script>-->
	<script src="assets/scripts/klorofil-common.js"></script>
	<script type="text/javascript" src="http://static.runoob.com/assets/qrcode/qrcode.min.js"></script>
	<script>
		function show(id) {

			var mytable = document.getElementById("display");
			var content = "epc:" + mytable.rows[id].cells[0].innerHTML+"id:" +mytable.rows[id].cells[1].innerHTML+"name:" +mytable.rows[id].cells[2].innerHTML;
			var qrcode = new QRCode('qrCode', {
				text: content,
				width: 256,
				height: 256,
				colorDark: '#000000',
				colorLight: '#ffffff',
				correctLevel: QRCode.CorrectLevel.H
			});
			$("body").append("<div class='mask'></div>");
			$(".mask").fadeIn("slow");
			$("#ImageBox").fadeIn("slow");
		}

		function downloadIamge(selector, name) {
			// 通过选择器获取img元素
			var img = document.querySelector(selector)
			// 将图片的src属性作为URL地址
			var url = img.src
			var a = document.createElement('a')
			var event = new MouseEvent('click')

			a.download = name || '下载图片名称'
			a.href = url

			a.dispatchEvent(event)
		}



	</script>

	<script>

		$(document).ready(function() {
			$.ajax({
				type: "POST",//方法类型
				dataType: "json",//预期服务器返回的数据类
				url: "ShowEPC" ,//url
				data: $('#form1').serialize(),
				success: function (result) {
					var Products=result.products;
					var num=result.number.number;
					var str="";
					str+="<tbody>";
					var t=1;
					for(var i=0;  i <num; i++){
						if(!(Products[i].id=="")){
							str+="<tr>";

							str+="<td>"+Products[i].id+"</td>";
							str+="<td>"+Products[i].name+"</td>";
							str+="<td>"+Products[i].EPC+"</td>";
							str+="<td>"+Products[i].eDate+"</td>";
							str+="<td>"+Products[i].lDate+"</td>";
							str+="<td><button type='button'class='btn btn-primary btn-sm btn-pop show' onclick='show(this.id)' id='"+t+"'>显示二维码</button></td>";
							str+="</tr>";
							t++;
						}

					}
					str+="</tbody>";
					$("#display").append(str);

				}
			});


		});
		$(function(){
			$("#btn-close").on('click', function () {
				$("#ImageBox").fadeOut("fast");
				$("#qrCode img").removeAttr("src")
				$(".mask").css({ display: 'none'});
			});

			$('#save').click(function(){

				downloadIamge("#qrCode img", '二维码')
			})
		});




	</SCRIPT>
</body>

</html>
